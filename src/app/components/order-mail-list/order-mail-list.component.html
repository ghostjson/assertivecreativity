<div class="order-mail-list-component mb-5 {{styleClass}}">
  <p-card header="Mail Thread">
    <p-scrollPanel #mailContainer [style]="{width: '100%', height: '80vh'}">
      <p-accordion 
        *ngIf="mails.length; else noMessages" 
        styleClass="mb-5" [multiple]="true"
      >
        <ng-container *ngFor="let mail of mails; first as isFirst">
          <p-accordionTab class="{{mail.sender.id == user.id ? 'user-msg' : 'reply-msg'}}" [selected]="isFirst">
            <ng-template pTemplate="header">
              <div class="message-header d-flex justify-content-between">
                <div class="author-details">
                  <span class="author-details__name">
                    {{ mail.sender.first_name + ' ' + mail.sender.last_name }}
                  </span>
                </div>
                <div class="message-meta">
                  {{ mail.created_at | date: "medium" }}
                </div>
              </div>
            </ng-template>
            <div [innerHtml]="mail.message_content"></div>
          </p-accordionTab>
        </ng-container>
      </p-accordion>
      <ng-template #noMessages>
        <p class="text-center">
          Send mail to see them here !
        </p>
      </ng-template>
    </p-scrollPanel>
  </p-card>

  <div class="compose-mail mt-5">
    <div class="compose-mail__writer">
      <p-editor
        [(ngModel)]="mailText"
        styleClass="shadow"
      ></p-editor>
    </div>
    <div class="compose-mail__footer d-flex justify-content-end">
      <p-button
        class="mt-3"
        label="Send Mail"
        icon="pi pi-chevron-right"
        iconPos="right"
        [disabled]="!mailText"
        (click)="sendMail()"
      ></p-button>
    </div>
  </div>
  <p-toast></p-toast>
</div>
