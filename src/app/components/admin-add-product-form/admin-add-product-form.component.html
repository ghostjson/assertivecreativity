<div class="product-form">
  <form [formGroup]="productForm">
    <p-card
      styleClass="form-card base-details mb-5"
    >
      <p-header styleClass="form-card__header">
        Enter the product details
      </p-header>
      <div class="form-card__body">
        <div class="form-group">
          <label class="form-group__label" for="name">
            Enter product name:
          </label>
          <div class="input-group">
            <input
              id="name"
              formControlName="name"
              type="text"
              class="input-group__input"
              pInputText
            />
          </div>
        </div>
        <div class="form-group">
          <label class="form-group__label" for="serial">
            Enter product serial:
          </label>
          <div class="input-group">
            <input
              id="serial"
              formControlName="serial"
              type="text"
              class="input-group__input"
              pInputText
            />
          </div>
        </div>
        <div class="form-group">
          <label class="form-group__label" for="description">
            Enter product description:
          </label>
          <div class="input-group">
            <textarea
              class="input-group__input"
              id="description"
              formControlName="description"
              pInputTextarea
              [rows]="5"
              [cols]="30"
              autoResize="autoResize"
            ></textarea>
          </div>
        </div>
        <div class="form-group">
          <label class="form-group__label" for="base_price">
            Enter the price of the product:
          </label>
          <div class="select-price-mode">
            <span>Switch to price table: </span>
            <p-inputSwitch formControlName="price_table_mode"></p-inputSwitch>
          </div>
          <app-admin-price-table-input
            *ngIf="productForm.value.price_table_mode != '0'; else normalPrice"
            [formGroup]="productForm"
          ></app-admin-price-table-input>
          <ng-template
            #normalPrice
          >
            <div 
              class="p-inputgroup input-group"
            >
              <input
                id="base_price"
                formControlName="base_price"
                type="number"
                pInputText
                placeholder="Price Per Piece"
                class="input-group__input"
              />
              <i class="material-icons p-inputgroup-addon">
                money
              </i>
              <!-- <span class="ui-inputgroup-addon">.00</span>       -->
            </div>
          </ng-template>
        </div>
        <div class="form-group">
          <label class="form-group__label" for="stock">
            Stock Available
          </label>
          <div class="p-inputgroup input-group">
            <input
              id="stock"
              formControlName="stock"
              type="number"
              pInputText
              placeholder="Stock Currently Available"
              class="input-group__input"
            />
            <i class="material-icons p-inputgroup-addon">
              store_mall_directory
            </i>
            <!-- <span class="ui-inputgroup-addon">.00</span>       -->
          </div>
        </div>
        <div class="form-group">
          <label class="form-group__label" for="category">
            Select a product category
          </label>
          <div>
            <app-admin-category-selector
              id="category"
              [formGroup]="productForm"
              [categories]="categories"
              (onSelect)="getTags($event)"
            ></app-admin-category-selector>
          </div>
        </div>
        <div class="form-group">
          <label class="form-group__label" for="tags">
            Select product tags
          </label>
          <div>
            <app-admin-tag-selector
              id="tags"
              [formGroup]="productForm"
              [tags]="tags"
            ></app-admin-tag-selector>
          </div>
        </div>
        <div class="form-group">
          <label class="form-group__label" for="image">
            Upload product images
          </label>
          <div class="input-group">
            <p-fileUpload
              id="image"
              name="file"
              url="http://assertivecreativity-frontend.s3-website.us-east-2.amazonaws.com/products/file/upload"
              accept="image/*"
              maxFileSize="1000000000"
              class="input-group__input"
            ></p-fileUpload>
          </div>
          <!--
            TODO: Add the below to p-fileUpload

            (uploadHandler)="uploadImages($event)"
            customUpload="true"

            ***** uploadHandler is defined in the typescript file of this component ******
          -->
        </div>
      </div>
    </p-card>

    <ng-container
      formArrayName="custom_forms"
      *ngFor="let customForm of customForms().controls; let i = index"
    >
      <app-admin-custom-form
        [formArray]="customForms()"
        [formGroup]="customForm"
        [formId]="i"
        [formCount]="customForms().length"
      ></app-admin-custom-form>
    </ng-container>
    <div class="add-new-custom-form d-flex mb-5 p-3">
      <label class="sr-only" for="add-new-custom-form__input">
        Add a new custom form
      </label>
      <input
        type="text"
        name="add-new-custom-form__input"
        id="add-new-custom-form__input"
        class="add-new-custom-form__input flex-grow-1"
        pInputText
        #newCustomFormTitle
      />
      <div class="add-new-custom-form__add-btn ml-2">
        <button (click)="addCustomForm()" class="btn btn-primary">
          <i class="material-icons">
            add
          </i>
        </button>
      </div>
    </div>

    <button (click)="onSubmit()" class="btn btn-primary">
      <ng-container *ngIf="isEdit; else addProduct">
        Save Product
      </ng-container>
      <ng-template #addProduct>
        Add Product
      </ng-template>
    </button>
  </form>
</div>
